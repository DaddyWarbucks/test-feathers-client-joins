{"version":3,"sources":["../node_modules/shared sync /^/.//.*$","App.jsx","index.js","feathers/app.js","feathers/app.hooks.js","feathers/batchClient.js","feathers/posts.js","feathers/profile.js","feathers/comments.js","feathers/users.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","App","props","componentDidMount","a","app","authenticate","strategy","email","password","loadPosts","setState","loading","service","create","start","Date","getTime","find","query","$sort","_id","$limit","state","limit","method","joinLocation","posts","end","serverProfile","clientProfile","duration","error","provider","URLSearchParams","window","location","search","get","useBatch","this","className","href","disabled","onClick","set","target","rel","type","value","onChange","event","message","style","width","height","JSON","stringify","React","Component","ReactDOM","render","StrictMode","document","getElementById","process","hrtime","require","profiler","getProfile","clearProfile","feathers","API_PATH","ENV","configure","rest","fetch","socketio","io","timeout","authentication","mixins","push","loaderFactory","opts","params","options","multi","serviceParams","paginate","BatchLoader","$in","getUniqueKeys","result","getResultsByKey","data","rec","profile","comments","users","logger","stats","hooks","appHooks","batchClient","batchService","exclude","setup","before","all","setupLoader","paramsForServer","update","patch","remove","after","context","console","convert","BatchManager","batches","batch","setTimeout","flush","currentBatches","calls","payload","results","forEach","index","callResult","status","reject","reason","makeArguments","excludes","concat","manager","collectBatches","path","includes","args","batchPromise","Promise","addBatchCall","switchHook","Profile","use","_log"],"mappings":"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","file":"static/js/main.3691d80a.chunk.js","sourcesContent":["var map = {\n\t\"./\": 3,\n\t\"./comments\": 64,\n\t\"./comments.js\": 64,\n\t\"./index\": 3,\n\t\"./index.js\": 3,\n\t\"./package\": 68,\n\t\"./package.json\": 68,\n\t\"./posts\": 69,\n\t\"./posts.js\": 69,\n\t\"./users\": 70,\n\t\"./users.js\": 70,\n\t\"./yarn.lock\": 171\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 125;","import React from 'react';\nimport app from './feathers/app';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    const urlParams = new URLSearchParams(window.location.search);\n    const provider = urlParams.get('provider') || 'socket';\n\n    this.state = {\n      loading: true,\n      error: null,\n      serverProfile: null,\n      clientProfile: null,\n      posts: null,\n      duration: null,\n      useBatch: false,\n      limit: 100,\n      method: 'primary',\n      joinLocation: 'client',\n      provider\n    };\n  }\n\n  componentDidMount = async () => {\n    await app.authenticate({\n      strategy: 'local',\n      email: 'na@example.com',\n      password: 'password'\n    });\n\n    this.loadPosts();\n  };\n\n  loadPosts = async () => {\n    this.setState({ loading: true });\n    try {\n      await app.service('server/profile').create({});\n      await app.service('client/profile').create({});\n\n      const start = new Date().getTime();\n      const posts = await app.service('api/posts').find({\n        query: {\n          $sort: { _id: 1 },\n          $limit: this.state.limit\n        },\n        method: this.state.method,\n        joinLocation: this.state.joinLocation\n      });\n      const end = new Date().getTime();\n\n      const serverProfile = await app.service('server/profile').find();\n      const clientProfile = await app.service('client/profile').find();\n\n      this.setState({\n        posts,\n        duration: end - start,\n        serverProfile,\n        clientProfile,\n        loading: false,\n        error: null\n      });\n    } catch (error) {\n      this.setState({\n        error,\n        loading: false\n      });\n    }\n  };\n\n  render() {\n    const {\n      loading,\n      error,\n      serverProfile,\n      clientProfile,\n      posts,\n      duration,\n      useBatch,\n      limit,\n      method,\n      joinLocation,\n      provider\n    } = this.state;\n\n    return (\n      <div className=\"container mt-4\">\n        <div className=\"row\">\n          <div className=\"col col-sm-6\">\n            <div className=\"mb-4\">\n              <h4>Provider</h4>\n              <div className=\"btn-group mb-2\">\n                <a\n                  className={`btn btn-secondary ${\n                    provider === 'socket' ? 'active' : ''\n                  }`}\n                  href=\"/?provider=socket\"\n                >\n                  Socket\n                </a>\n                <a\n                  className={`btn btn-secondary ${\n                    provider === 'rest' ? 'active' : ''\n                  }`}\n                  href=\"/?provider=rest\"\n                >\n                  REST\n                </a>\n              </div>\n              <p>\n                Configure the feathers-client to make calls either via Socket or\n                REST\n              </p>\n            </div>\n\n            <div className=\"mb-4\">\n              <h4>Join Location</h4>\n              <div className=\"btn-group mb-2\">\n                <button\n                  disabled={loading}\n                  className={`btn btn-primary ${\n                    joinLocation === 'client' && !useBatch ? 'active' : ''\n                  }`}\n                  onClick={() => {\n                    this.setState(\n                      { joinLocation: 'client', useBatch: false },\n                      () => {\n                        this.loadPosts();\n                        app.set('useBatch', false);\n                      }\n                    );\n                  }}\n                >\n                  Client\n                </button>\n                <button\n                  disabled={loading}\n                  className={`btn btn-primary ${\n                    joinLocation === 'server' ? 'active' : ''\n                  }`}\n                  onClick={() => {\n                    this.setState(\n                      { joinLocation: 'server', useBatch: false },\n                      () => {\n                        this.loadPosts();\n                        app.set('useBatch', false);\n                      }\n                    );\n                  }}\n                >\n                  Server\n                </button>\n                <button\n                  disabled={loading}\n                  className={`btn btn-primary ${useBatch ? 'active' : ''}`}\n                  onClick={() => {\n                    this.setState(\n                      { joinLocation: 'client', useBatch: true },\n                      () => {\n                        this.loadPosts();\n                        app.set('useBatch', true);\n                      }\n                    );\n                  }}\n                >\n                  feathers-batch\n                </button>\n              </div>\n              <p>\n                Choose between doing the joins on the client or the server. See\n                also{' '}\n                <a\n                  href=\"https://github.com/feathersjs-ecosystem/feathers-batch\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  feathers-batch\n                </a>\n                . Note that when using feathers-batch, you will see lots of\n                client side calls, but its imporant to understand that these\n                calls are not actual HTTP calls. The service was called, but it\n                did not make a socket/rest request. It simply created\n                \"intructions\" for feathers-batch.\n              </p>\n            </div>\n\n            <div className=\"mb-4\">\n              <h4>Methods</h4>\n              <div className=\"btn-group mb-2\">\n                <button\n                  disabled={loading}\n                  className={`btn btn-primary ${\n                    method === 'primary' ? 'active' : ''\n                  }`}\n                  onClick={() => {\n                    this.setState({ method: 'primary' }, this.loadPosts);\n                  }}\n                >\n                  Get/Find\n                </button>\n                <button\n                  disabled={loading}\n                  className={`btn btn-primary ${\n                    method === 'cached' ? 'active' : ''\n                  }`}\n                  onClick={() => {\n                    this.setState({ method: 'cached' }, this.loadPosts);\n                  }}\n                >\n                  Cached Get/Find\n                </button>\n                <button\n                  disabled={loading}\n                  className={`btn btn-primary ${\n                    method === 'load' ? 'active' : ''\n                  }`}\n                  onClick={() => {\n                    this.setState({ method: 'load' }, this.loadPosts);\n                  }}\n                >\n                  Load/LoadMany\n                </button>\n              </div>\n              <ul>\n                <li className=\"mb-2\">\n                  Get/Find - Use standard Feathers .get() and .find() methods\n                </li>\n                <li className=\"mb-2\">\n                  Cached Get/Find - Use feathers-dataloader cached .get() and\n                  .find() methods. These are similar to basic Feathers get/find\n                  methods, but the request is cached and reused if another\n                  request with same id/params is made.\n                </li>\n                <li>\n                  Load/LoadMany - Use feathers-dataloader .load() and\n                  .loadMany() methods\n                </li>\n              </ul>\n            </div>\n\n            <div className=\"mb-4\">\n              <h4>Limit</h4>\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                value={limit}\n                onChange={(event) => {\n                  const limit = event.target.value;\n                  this.setState(\n                    {\n                      limit\n                    },\n                    () => {\n                      if (limit) {\n                        this.loadPosts();\n                      }\n                    }\n                  );\n                }}\n              />\n            </div>\n          </div>\n          <div className=\"col col-sm-6\">\n            <div className=\"bg-light rounded p-3\">\n              <p>\n                This is a basic example app that compares doing joins/population\n                on the client vs on the server. It is also a test bed and\n                exmaple of a new v2 for{' '}\n                <a\n                  href=\"https://github.com/feathersjs-ecosystem/batch-loader/tree/v2\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  feathers-dataloader\n                </a>\n                . See also the{' '}\n                <a\n                  href=\"https://github.com/feathersjs-ecosystem/batch-loader/issues/18\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  v2 RFC\n                </a>{' '}\n                and leave some feedback! You can also checkout the{' '}\n                <a\n                  href=\"https://github.com/DaddyWarbucks/test-feathers-client-joins\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  source code\n                </a>{' '}\n                for this project. Specifically, see the <code>shared</code>{' '}\n                direcotry.\n              </p>\n              <p>\n                The app consists of 5,000 <code>posts</code>. The posts then\n                join a <code>user</code> and <code>comments</code>. Each user\n                then joins on a <code>bio</code>, and each comment subsequently\n                joins on its <code>user</code> (and subsequently its bio).\n              </p>\n              <ul>\n                <li className=\"mb-2\">\n                  5,000 posts, each with random <code>user_id</code>\n                </li>\n                <li className=\"mb-2\">\n                  10,000 comments, each with random <code>user_id</code> and{' '}\n                  <code>post_id</code>\n                </li>\n                <li className=\"mb-2\">\n                  100 users, each with corresponding <code>bio_id</code>\n                </li>\n                <li className=\"mb-2\">100 bios</li>\n              </ul>\n              <p>\n                These relationships represent a good example of nested joins\n                where some of those joins are \"repeating\" resources, such as the\n                post joining its author and comments joinging their user. This\n                is an excellent usecase for <code>feathers-datalader</code>.\n              </p>\n              <p>\n                The app also uses{' '}\n                <a\n                  href=\"https://github.com/feathersjs-ecosystem/feathers-batch\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  feathers-batch\n                </a>\n                , which is a clever way of allowing the client to specify which\n                joins to do, but actually executes that code on the server.\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {error && <div className=\"alert alert-danger\">{error.message}</div>}\n\n        <div className=\"mb-4 p-3 bg-light rounded\">\n          <h3>\n            Duration:{' '}\n            {loading ? (\n              <div\n                className=\"spinner-border\"\n                style={{\n                  width: '2rem',\n                  height: '2rem'\n                }}\n              ></div>\n            ) : (\n              <span className=\"text-success\">{duration}ms</span>\n            )}\n          </h3>\n        </div>\n\n        <div className=\"row mb-4\">\n          <div className=\"col\">\n            <h4>Server Profile</h4>\n            {serverProfile && (\n              <pre className=\"p-3 bg-light rounded\">\n                {JSON.stringify(serverProfile, null, 2)}\n              </pre>\n            )}\n          </div>\n          <div className=\"col\">\n            <h4>Client Profile</h4>\n            {clientProfile && (\n              <pre className=\"p-3 bg-light rounded\">\n                {JSON.stringify(clientProfile, null, 2)}\n              </pre>\n            )}\n          </div>\n        </div>\n        <div>\n          <div className=\"mb-4\">\n            <h4>Results</h4>\n            {posts && (\n              <pre className=\"p-3 bg-light rounded\">\n                {JSON.stringify(posts, null, 2)}\n              </pre>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","import io from 'socket.io-client';\nimport feathers from '@feathersjs/client';\nimport BatchLoader from '@feathers-plus/batch-loader';\nimport appHooks from './app.hooks';\n// import { batchClient } from 'feathers-batch/client';\nimport { batchClient } from './batchClient';\n\nimport posts from './posts';\nimport profile from './profile';\nimport comments from './comments';\nimport users from './users';\n\nprocess.hrtime = require('browser-process-hrtime');\nconst { profiler, getProfile, clearProfile } = require('feathers-profiler');\n\nconst app = feathers();\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst provider = urlParams.get('provider') || 'socket';\n\nconst API_PATH = process.env.ENV === 'production' ? '/' : 'http://localhost:3030'\n\nif (provider === 'rest') {\n  app.configure(feathers.rest(API_PATH).fetch(fetch));\n} else {\n  app.configure(\n    feathers.socketio(io(API_PATH), { timeout: 100000 })\n  );\n}\n\napp.configure(feathers.authentication());\n\n// Add a nice mixin to services that allow you to easily\n// create batchLoaders w/o all the config\napp.mixins.push(function (service) {\n  service.loaderFactory = function (opts = {}) {\n    if (!service.find) {\n      throw new Error(\n        `Cannot call the loaderFactory() method on this service because it does not have a find() method.`\n      );\n    }\n    const { params = {}, ...rest } = opts;\n    const options = {\n      id: '_id',\n      multi: false,\n      ...rest\n    };\n    const serviceParams = {\n      paginate: false,\n      ...params\n    };\n    return new BatchLoader(async (keys) => {\n      const result = await service.find({\n        ...serviceParams,\n        query: {\n          [options.id]: { $in: BatchLoader.getUniqueKeys(keys) },\n          ...serviceParams.query\n        }\n      });\n      return BatchLoader.getResultsByKey(\n        keys,\n        result.data ? result.data : result,\n        (rec) => rec[options.id],\n        options.multi ? '[!]' : '!'\n      );\n    });\n  };\n});\n\napp.configure(posts);\napp.configure(profile);\napp.configure(comments);\napp.configure(users);\n\n// Setup profiler\napp.configure(\n  profiler({\n    logger: null,\n    stats: 'total'\n  })\n);\n\napp.set('profiler', {\n  getProfile,\n  clearProfile\n});\n\napp.hooks(appHooks);\n\n// Setup feathers-batch\napp.configure(\n  batchClient({\n    batchService: 'api/batch',\n    exclude: ['server/profile', 'client/profile', 'authentication']\n  })\n);\n\napp.setup(app);\n\nexport default app;\n","import { setupLoader, paramsForServer } from 'shared';\n\nexport default {\n  before: {\n    all: [setupLoader, paramsForServer],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  after: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  error: {\n    all: [\n      (context) => {\n        console.error(context.error);\n      }\n    ],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  }\n};\n","// Note this file is directly copy pasted from the\n// feathers-batch source code so that it can add\n// the code on lines 75-77. It is also updated\n// to use ESM modules instead of CommonJS so\n// CRA does not bark...\n// It is otherwise unchanged.\n\nconst { convert } = require('@feathersjs/errors');\n\nexport class BatchManager {\n  constructor(app, options) {\n    this.app = app;\n    this.batches = [];\n    this.timeout = null;\n    this.options = options;\n  }\n\n  addBatchCall(batch) {\n    this.batches.push(batch);\n\n    if (this.timeout === null) {\n      this.timeout = setTimeout(() => this.flush(), this.options.timeout || 50);\n    }\n  }\n\n  async flush() {\n    const currentBatches = this.batches;\n\n    this.batches = [];\n    this.timeout = null;\n\n    const { batchService } = this.options;\n    const results = await this.app.service(batchService).create({\n      calls: currentBatches.map(({ payload }) => payload)\n    });\n\n    currentBatches.forEach((batch, index) => {\n      const callResult = results[index];\n\n      if (callResult.status === 'fulfilled') {\n        batch.resolve(callResult.value);\n      } else {\n        batch.reject(convert(callResult.reason));\n      }\n    });\n  }\n}\n\nexport const makeArguments = (context) => {\n  const { query = {} } = context.params;\n\n  switch (context.method) {\n    case 'get':\n    case 'remove':\n      return [context.id, query];\n    case 'update':\n    case 'patch':\n      return [context.id, context.data, query];\n    case 'create':\n      return [context.data, query];\n    default:\n      return [query];\n  }\n};\n\nexport const batchClient = (options) => (app) => {\n  if (typeof options.batchService !== 'string') {\n    throw new Error('`batchService` name option must be passed to batchClient');\n  }\n\n  const excludes = (options.exclude || []).concat(options.batchService);\n  const manager = new BatchManager(app, options);\n  const collectBatches = async (context) => {\n    const { method, path } = context;\n\n    if (!app.get('useBatch')) {\n      return context;\n    }\n\n    if (excludes.includes(path)) {\n      return context;\n    }\n\n    const args = makeArguments(context);\n    const payload = [method, path, ...args];\n    const batchPromise = new Promise((resolve, reject) =>\n      manager.addBatchCall({\n        resolve,\n        reject,\n        payload\n      })\n    );\n\n    context.result = await batchPromise;\n\n    return context;\n  };\n\n  app.hooks({\n    before: collectBatches\n  });\n};\n","import { switchHook } from 'shared';\n\nexport default (app) => {\n  app.service('api/posts').hooks({\n    before: {\n      all: []\n    },\n    after: {\n      all: [switchHook('posts', 'client')]\n    }\n  });\n};\n","export default (app) => {\n  class Profile {\n    constructor(options, app) {\n      this.options = options || {};\n    }\n\n    setup(app) {\n      this.app = app;\n      this.profiler = app.get('profiler');\n    }\n\n    async find(params) {\n      return this.profiler.getProfile();\n    }\n\n    async create(data, params) {\n      if (this.profiler.getProfile()) {\n        this.profiler.clearProfile();\n      }\n      return {};\n    }\n  }\n\n  app.use('client/profile', new Profile());\n\n  app.service('client/profile').hooks({\n    after: {\n      all: [\n        (context) => {\n          delete context._log;\n          delete context.result['client/profile'];\n          delete context.result['server/profile'];\n          return context;\n        }\n      ]\n    }\n  });\n\n  return app;\n};\n","import { switchHook } from 'shared';\n\nexport default (app) => {\n  app.service('api/comments').hooks({\n    before: {\n      all: []\n    },\n    after: {\n      all: [switchHook('comments', 'client')]\n    }\n  });\n};\n","import { switchHook } from 'shared';\n\nexport default (app) => {\n  app.service('api/users').hooks({\n    before: {\n      all: []\n    },\n    after: {\n      all: [switchHook('users', 'client')]\n    }\n  });\n};\n"],"sourceRoot":""}